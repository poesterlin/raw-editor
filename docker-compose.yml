services:
#   db:
#     image: postgres
#     restart: always
#     ports:
#       - 5432:5432
#     environment:
#       POSTGRES_USER: root
#       POSTGRES_PASSWORD: mysecretpassword
#       POSTGRES_DB: local
#     volumes:
#       - pgdata:/var/lib/postgresql/data
# volumes:
#   pgdata:

  editor:
    build: 
      context: .
      dockerfile: Dockerfile
      args:
        DATABASE_URL: ${DATABASE_URL}
    env_file: 
     - .env
    environment:
      - CLUT_DIR=/app/cluts
      - IMG_DIR=/app/images
      - IMPORT_DIR=/app/import
      - EXPORT_DIR=/app/export
    volumes:
      - ./cluts:/app/cluts
      - ./images:/app/images
      - ./import:/app/import
      - ./export:/app/export
    networks:
      - traefik_web
    labels:
      - "traefik.enable=true"
      - "traefik.http.routers.editor.rule=Host(`${HOST_DOMAIN}`)"
      - "traefik.http.services.editor.loadbalancer.server.port=3000"

networks:
  traefik_web:
    external: true
